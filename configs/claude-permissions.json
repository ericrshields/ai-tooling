{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Comprehensive Claude Code permissions: allow non-destructive operations, deny exceptionally dangerous commands. See quality-gates.md and mcp-integration-patterns.md for patterns.",
  "permissions": {
    "allow": [
      "// ==================== FILE OPERATIONS (READ-ONLY) ====================",
      "Read(**/*)",
      "Glob(**/*)",
      "Grep(**/*)",

      "// ==================== GIT OPERATIONS (READ-ONLY) ====================",
      "Bash(git status:*)",
      "Bash(git status)",
      "Bash(git diff:*)",
      "Bash(git diff)",
      "Bash(git log:*)",
      "Bash(git log)",
      "Bash(git show:*)",
      "Bash(git show)",
      "Bash(git branch:*)",
      "Bash(git branch)",
      "Bash(git remote:*)",
      "Bash(git remote)",
      "Bash(git ls-files:*)",
      "Bash(git ls-files)",
      "Bash(git rev-parse:*)",
      "Bash(git rev-parse)",
      "Bash(git config --get:*)",
      "Bash(git config --list)",
      "Bash(git describe:*)",
      "Bash(git tag --list:*)",
      "Bash(git tag -l:*)",
      "Bash(git blame:*)",
      "Bash(git reflog:*)",

      "// ==================== GIT OPERATIONS (SAFE WRITES) ====================",
      "Bash(git add:*)",
      "Bash(git add .)",
      "Bash(git stash:*)",
      "Bash(git stash)",
      "Bash(git checkout -b:*)",
      "Bash(git switch -c:*)",
      "Bash(git pull:*)",
      "Bash(git pull)",
      "Bash(git fetch:*)",
      "Bash(git fetch)",

      "// ==================== FILE SYSTEM (READ-ONLY) ====================",
      "Bash(ls:*)",
      "Bash(ls)",
      "Bash(find:*)",
      "Bash(find .)",
      "Bash(tree:*)",
      "Bash(tree)",
      "Bash(cat:*)",
      "Bash(head:*)",
      "Bash(tail:*)",
      "Bash(grep:*)",
      "Bash(grep)",
      "Bash(egrep:*)",
      "Bash(rg:*)",
      "Bash(rg)",
      "Bash(wc:*)",
      "Bash(wc)",
      "Bash(du:*)",
      "Bash(du)",
      "Bash(stat:*)",
      "Bash(file:*)",
      "Bash(which:*)",
      "Bash(whereis:*)",
      "Bash(type:*)",
      "Bash(pwd)",

      "// ==================== NODE/NPM (BUILD & TEST) ====================",
      "Bash(npm run build:*)",
      "Bash(npm run build)",
      "Bash(npm run test:*)",
      "Bash(npm run test)",
      "Bash(npm run lint:*)",
      "Bash(npm run lint)",
      "Bash(npm test:*)",
      "Bash(npm test)",
      "Bash(npm run dev:*)",
      "Bash(npm run dev)",
      "Bash(npm run start:*)",
      "Bash(npm run start)",
      "Bash(npm run type-check:*)",
      "Bash(npm run type-check)",
      "Bash(npm run format:*)",
      "Bash(npm run format)",
      "Bash(npm run validate:*)",
      "Bash(npm run validate)",

      "// ==================== NODE/NPM (READ-ONLY INFO) ====================",
      "Bash(npm list:*)",
      "Bash(npm list)",
      "Bash(npm ls:*)",
      "Bash(npm outdated:*)",
      "Bash(npm outdated)",
      "Bash(npm view:*)",
      "Bash(npm info:*)",
      "Bash(npm search:*)",
      "Bash(npm show:*)",
      "Bash(npm --version)",
      "Bash(npm -v)",
      "Bash(node --version)",
      "Bash(node -v)",
      "Bash(npx --version)",

      "// ==================== NPX (COMMON TOOLS) ====================",
      "Bash(npx eslint:*)",
      "Bash(npx prettier:*)",
      "Bash(npx tsc:*)",
      "Bash(npx jest:*)",
      "Bash(npx playwright:*)",
      "Bash(npx cypress:*)",
      "Bash(npx vite:*)",
      "Bash(npx webpack:*)",

      "// ==================== YARN (IF USED) ====================",
      "Bash(yarn build:*)",
      "Bash(yarn build)",
      "Bash(yarn test:*)",
      "Bash(yarn test)",
      "Bash(yarn lint:*)",
      "Bash(yarn lint)",
      "Bash(yarn run:*)",
      "Bash(yarn list:*)",
      "Bash(yarn --version)",

      "// ==================== GITHUB CLI (READ-ONLY) ====================",
      "Bash(gh pr view:*)",
      "Bash(gh pr list:*)",
      "Bash(gh pr status:*)",
      "Bash(gh pr diff:*)",
      "Bash(gh pr checks:*)",
      "Bash(gh issue view:*)",
      "Bash(gh issue list:*)",
      "Bash(gh repo view:*)",
      "Bash(gh run view:*)",
      "Bash(gh run list:*)",
      "Bash(gh api:*)",
      "Bash(gh --version)",

      "// ==================== RCLONE (READ-ONLY) ====================",
      "Bash(rclone ls:*)",
      "Bash(rclone lsd:*)",
      "Bash(rclone lsl:*)",
      "Bash(rclone lsf:*)",
      "Bash(rclone lsjson:*)",
      "Bash(rclone size:*)",
      "Bash(rclone about:*)",
      "Bash(rclone config show:*)",
      "Bash(rclone config show)",
      "Bash(rclone version)",
      "Bash(rclone --version)",

      "// ==================== PANDOC ====================",
      "Bash(pandoc:*)",
      "Bash(pandoc --version)",

      "// ==================== JQ/YQ (JSON/YAML PROCESSING) ====================",
      "Bash(jq:*)",
      "Bash(jq --version)",
      "Bash(yq:*)",
      "Bash(yq --version)",

      "// ==================== DOCKER (READ-ONLY) ====================",
      "Bash(docker ps:*)",
      "Bash(docker ps)",
      "Bash(docker images:*)",
      "Bash(docker images)",
      "Bash(docker logs:*)",
      "Bash(docker inspect:*)",
      "Bash(docker version)",
      "Bash(docker --version)",
      "Bash(docker-compose ps:*)",
      "Bash(docker-compose ps)",
      "Bash(docker-compose logs:*)",
      "Bash(docker-compose config:*)",

      "// ==================== CURL/WGET (READ-ONLY) ====================",
      "Bash(curl -I:*)",
      "Bash(curl -s:*)",
      "Bash(curl --head:*)",
      "Bash(wget --spider:*)",
      "Bash(wget -q:*)",

      "// ==================== SYSTEM INFO ====================",
      "Bash(date:*)",
      "Bash(date)",
      "Bash(uptime)",
      "Bash(hostname)",
      "Bash(whoami)",
      "Bash(id)",
      "Bash(uname:*)",
      "Bash(uname)",
      "Bash(df:*)",
      "Bash(df)",
      "Bash(free:*)",
      "Bash(ps:*)",
      "Bash(top -bn1:*)",
      "Bash(env)",
      "Bash(printenv:*)",
      "Bash(echo:*)",

      "// ==================== TEXT PROCESSING ====================",
      "Bash(sed -n:*)",
      "Bash(awk:*)",
      "Bash(sort:*)",
      "Bash(uniq:*)",
      "Bash(cut:*)",
      "Bash(tr:*)",
      "Bash(diff:*)",
      "Bash(comm:*)",
      "Bash(cmp:*)",

      "// ==================== COMPRESSION (READ-ONLY) ====================",
      "Bash(tar -tzf:*)",
      "Bash(tar -tf:*)",
      "Bash(unzip -l:*)",
      "Bash(gzip -l:*)",
      "Bash(gunzip -l:*)",

      "// ==================== CHECKSUM/HASH ====================",
      "Bash(md5sum:*)",
      "Bash(sha1sum:*)",
      "Bash(sha256sum:*)",
      "Bash(shasum:*)",

      "// ==================== NETWORK (READ-ONLY) ====================",
      "Bash(ping -c:*)",
      "Bash(nc -zv:*)",
      "Bash(telnet:*)",
      "Bash(dig:*)",
      "Bash(nslookup:*)",
      "Bash(host:*)",
      "Bash(whois:*)",
      "Bash(ifconfig)",
      "Bash(ip addr:*)",

      "// ==================== TMUX/SCREEN (READ-ONLY) ====================",
      "Bash(tmux ls)",
      "Bash(tmux list-sessions)",
      "Bash(screen -ls)",

      "// ==================== MISC TOOLS ====================",
      "Bash(timeout:*)",
      "Bash(time:*)",
      "Bash(watch:*)",
      "Bash(tee:*)",
      "Bash(xargs:*)",
      "Bash(parallel:*)",
      "Bash(basename:*)",
      "Bash(dirname:*)",
      "Bash(realpath:*)",
      "Bash(readlink:*)",

      "// ==================== VALIDATION SCRIPTS ====================",
      "Bash(./validate-*.sh:*)",
      "Bash(./.quality-gates/*.sh:*)",
      "Bash(bash ./validate-*.sh:*)",
      "Bash(bash ./.quality-gates/*.sh:*)"
    ],

    "ask": [
      "// ==================== GIT WRITE OPERATIONS (MODERATE RISK) ====================",
      "// These operations modify git history or remote - require approval each time",
      "Bash(git commit:*)",
      "Bash(git push)",
      "Bash(git push -u:*)",
      "Bash(git push --set-upstream:*)",
      "Bash(git push origin:*)",
      "Bash(git merge:*)",
      "Bash(git rebase:*)",
      "Bash(git cherry-pick:*)",

      "// ==================== FILE OPERATIONS (MODERATE RISK) ====================",
      "// These can overwrite or delete files - require approval each time",
      "Write(**/*)",
      "Edit(**/*)",
      "Bash(mv:*)",
      "Bash(cp:*)",
      "Bash(rsync:*)",
      "Bash(rm:*)",
      "Bash(git clean:*)",

      "// ==================== PACKAGE MANAGEMENT (MODERATE RISK) ====================",
      "// These modify dependencies - require approval each time",
      "Bash(npm install:*)",
      "Bash(npm uninstall:*)",
      "Bash(npm ci:*)",
      "Bash(npm update:*)",
      "Bash(yarn add:*)",
      "Bash(yarn remove:*)",
      "Bash(yarn install:*)",

      "// ==================== GITHUB CLI (WRITE OPERATIONS) ====================",
      "Bash(gh pr create:*)",
      "Bash(gh pr merge:*)",
      "Bash(gh pr close:*)",
      "Bash(gh issue create:*)",
      "Bash(gh issue close:*)",
      "Bash(gh release create:*)",

      "// ==================== RCLONE (WRITE OPERATIONS) ====================",
      "Bash(rclone copy:*)",
      "Bash(rclone copyto:*)",
      "Bash(rclone move:*)",
      "Bash(rclone sync:*)",
      "Bash(rclone delete:*)"
    ],

    "deny": [
      "// ==================== DESTRUCTIVE GIT OPERATIONS ====================",
      "// Force operations that rewrite history or skip safety checks",
      "Bash(git push --force:*)",
      "Bash(git push -f:*)",
      "Bash(git reset --hard:*)",
      "Bash(git clean -fd:*)",
      "Bash(git clean -f:*)",
      "Bash(git clean -d:*)",
      "Bash(git branch -D:*)",
      "Bash(git tag -d:*)",
      "Bash(git rebase --skip:*)",
      "Bash(git filter-branch:*)",
      "Bash(git reflog delete:*)",

      "// ==================== DESTRUCTIVE FILE OPERATIONS ====================",
      "// Recursive, force, or bulk deletion operations",
      "Bash(rm -rf:*)",
      "Bash(rm -fr:*)",
      "Bash(rm -r:*)",
      "Bash(rm -f:*)",
      "Bash(rm *:*)",
      "Bash(rmdir -r:*)",
      "Bash(shred:*)",

      "// ==================== SYSTEM COMMANDS ====================",
      "Bash(sudo:*)",
      "Bash(su:*)",
      "Bash(chmod +x:*)",
      "Bash(chown:*)",
      "Bash(shutdown:*)",
      "Bash(reboot:*)",
      "Bash(halt:*)",
      "Bash(init:*)",
      "Bash(systemctl:*)",
      "Bash(service:*)",
      "Bash(kill -9:*)",
      "Bash(killall:*)",
      "Bash(pkill:*)",

      "// ==================== PACKAGE PUBLISHING ====================",
      "Bash(npm publish:*)",
      "Bash(npm unpublish:*)",
      "Bash(yarn publish:*)",
      "Bash(pnpm publish:*)",

      "// ==================== DATABASE OPERATIONS ====================",
      "Bash(*DROP TABLE:*)",
      "Bash(*DROP DATABASE:*)",
      "Bash(*DELETE FROM:*)",
      "Bash(*TRUNCATE:*)",
      "Bash(psql:* DROP:*)",
      "Bash(mysql:* DROP:*)",
      "Bash(mongosh:* drop:*)",

      "// ==================== SECRET FILES ====================",
      "Read(.env)",
      "Read(.env.*)",
      "Read(**/.env)",
      "Read(**/.env.*)",
      "Read(**/secrets/**)",
      "Read(**/*secret*)",
      "Read(**/*password*)",
      "Read(**/*credential*)",
      "Read(**/.aws/credentials)",
      "Read(**/.ssh/id_*)",
      "Read(**/.gnupg/**)",
      "Bash(cat .env:*)",
      "Bash(cat **/secrets/**)",
      "Bash(git add .env:*)",
      "Bash(git add **/secrets/**)",

      "// ==================== NETWORK ATTACKS ====================",
      "Bash(nmap:*)",
      "Bash(nc -e:*)",
      "Bash(nc -c:*)",
      "Bash(netcat -e:*)",
      "Bash(tcpdump:*)",
      "Bash(wireshark:*)",

      "// ==================== DISK/FILESYSTEM DANGEROUS ====================",
      "Bash(dd:*)",
      "Bash(mkfs:*)",
      "Bash(fdisk:*)",
      "Bash(parted:*)",
      "Bash(mount:*)",
      "Bash(umount:*)",

      "// ==================== EXECUTION ====================",
      "Bash(eval:*)",
      "Bash(exec:*)",
      "Bash(source /dev:*)",
      "Bash(. /dev:*)",

      "// ==================== DOCKER DESTRUCTIVE ====================",
      "Bash(docker rm:*)",
      "Bash(docker rmi:*)",
      "Bash(docker system prune:*)",
      "Bash(docker-compose down:*)",
      "Bash(docker-compose rm:*)",

      "// ==================== KUBERNETES ====================",
      "Bash(kubectl delete:*)",
      "Bash(kubectl drain:*)",
      "Bash(kubectl cordon:*)",
      "Bash(helm delete:*)",
      "Bash(helm uninstall:*)",

      "// ==================== CLOUD PROVIDERS ====================",
      "Bash(aws s3 rm:*)",
      "Bash(aws ec2 terminate:*)",
      "Bash(gcloud compute instances delete:*)",
      "Bash(az vm delete:*)",
      "Bash(terraform destroy:*)",

      "// ==================== DEPLOYMENT ====================",
      "Bash(*deploy*production:*)",
      "Bash(*prod*deploy:*)",
      "Bash(vercel --prod:*)",
      "Bash(netlify deploy --prod:*)",
      "Bash(firebase deploy --only hosting:production:*)"
    ]
  },

  "hooks": {
    "PermissionRequest": [
      {
        "matcher": "ask",
        "hooks": [
          {
            "type": "prompt",
            "prompt": "Moderate risk operation. Requires explicit approval for each invocation to prevent unintended modifications."
          }
        ]
      }
    ]
  }
}
